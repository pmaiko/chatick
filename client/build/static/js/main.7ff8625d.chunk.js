(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{126:function(e,t){},130:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(26),o=a.n(r),c=a(31),l=a(16),m=a(69),i=a(3),u="LOGIN",d="CHECK_LOGGED",p="LOGOUT",g=a(17),f=a.n(g),h="".concat(window.location.protocol,"/api/v1/"),v="".concat(window.location.host),b=function(e,t){f.a.post(h+"register-user",e).then((function(e){t(e)}))},N=function(e,t){f.a.post(h+"login",e).then((function(e){t(e)}))},E=a(42),O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.localStorage.getItem("token"),t={};if(e){var a=e;t.token=a;(a=(a=a.replace("Bearer ","")).split("."))[0];var s=a[1];a[2];s=JSON.parse(E.Base64.decode(s)),t.userId=s.userId,t.firstName=s.firstName,t.lastName=s.lastName,t.email=s.email,f.a.defaults.headers.common.Authorization=e,t.logged=!0,localStorage.setItem("token",e)}return t},j={login:function(e,t){var a=this;return function(s){N({email:e,password:t},(function(e){var t=O(e.data);s(a.loginRequest(Object(i.a)({type:u},t)))}))}},loginRequest:function(e){return e},checkLogged:function(){var e=O();return Object(i.a)({type:d},e)},logout:function(){return{type:p}}},k={logged:!1,token:void 0,userId:"",firstName:"",lastName:"",email:""};var w=Object(l.c)({auth:function(e,t){if("undefined"===typeof e)return k;switch(t.type){case u:e=Object(i.a)({},t);break;case d:t.token?e=Object(i.a)({},t):(e.token=void 0,e.logged=!1);break;case p:window.localStorage.removeItem("token"),f.a.defaults.headers.common.Authorization="",e.token=void 0,e.logged=!1}return e}}),I=Object(i.a)({},j),y=function(e){return Object(i.a)({},e)},C=Object(i.a)({},I),_=function(e){return Object(c.b)(y,C)(e)},M=a(14),S=a(15);var L=_((function(e){var t=Object(M.f)(),a=e.auth.logged;return n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"logo"},"Chatick"),a?n.a.createElement("div",{className:"actions"},n.a.createElement("a",{href:"#",onClick:function(a){a.preventDefault(),e.logout(),t.push("/")}},"Logout")):n.a.createElement("div",{className:"actions"},n.a.createElement(S.b,{to:"/registration"},"Sign Up")))})),x=a(4),F=a(11);var G=_((function(e){var t=Object(M.f)();Object(s.useEffect)((function(){e.auth.logged&&t.push("/chatWrapper")}),[e.auth.logged]);var a=Object(s.useState)({email:"",password:""}),r=Object(F.a)(a,2),o=r[0],c=r[1],l=function(e){c(Object(i.a)({},o,Object(x.a)({},e.target.name,e.target.value)))};return n.a.createElement("div",{className:"sign-in form"},n.a.createElement("div",{className:"form"},n.a.createElement("div",{className:"form__title"},"LOGIN"),n.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.login(o.email,o.password)}},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"email"},"Email address"),n.a.createElement("input",{type:"email",className:"form-control",name:"email",id:"email",autoComplete:"username",placeholder:"Enter email",value:o.email,onChange:l}),n.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"},"We'll never share your email with anyone else.")),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",name:"password",id:"password",autoComplete:"current-password",placeholder:"Password",value:o.password,onChange:l})),n.a.createElement("div",{className:"form__buttons"},n.a.createElement("button",{type:"submit",className:"btn btn-primary w-100"},"Login")))))})),W=a(71);var U=_((function(e){var t=Object(M.f)(),a=Object(W.a)(),r=a.register,o=a.handleSubmit,c=(a.watch,a.errors,Object(s.useState)({firstName:"",lastName:"",email:"",password:""})),l=Object(F.a)(c,2),m=l[0],u=l[1],d=function(e){u(Object(i.a)({},m,Object(x.a)({},e.target.name,e.target.value)))};return n.a.createElement("div",{className:"sign-up"},n.a.createElement("div",{className:"form"},n.a.createElement("div",{className:"form__title"},"Registration"),n.a.createElement("form",{onSubmit:o((function(){b(m,(function(e){console.log(e)}))}))},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"firstName"},"First Name"),n.a.createElement("input",{type:"text",className:"form-control",id:"firstName",name:"firstName",placeholder:"First Name",ref:r({required:!0}),onChange:d,value:m.firstName})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"lastName"},"Last Name"),n.a.createElement("input",{type:"text",className:"form-control",id:"lastName",name:"lastName",placeholder:"Last Name",onChange:d,value:m.lastName})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"email"},"Email address"),n.a.createElement("input",{type:"email",className:"form-control",id:"email",name:"email",autoComplete:"username",placeholder:"Enter email",onChange:d,value:m.email})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",id:"password",name:"password",placeholder:"Password",autoComplete:"current-password",onChange:d,value:m.password})),n.a.createElement("div",{className:"form__buttons"},n.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Registration"),n.a.createElement("button",{onClick:function(){t.push("/")},className:"btn btn-dark"},"Cancel")))))})),D=a(5),P=a(28),R=a(29),q=a(32),B=a(30),J=a(33),z=_(function(e){function t(e){var a;return Object(P.a)(this,t),(a=Object(q.a)(this,Object(B.a)(t).call(this,e)))._isMounted=!1,a.handleChange=function(e){var t=a.state;t.messageInput=e.target.value,a.setState(Object(i.a)({},t))},a.state={messageInput:"",messages:[]},a}return Object(J.a)(t,e),Object(R.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.auth.logged&&this.props.socket.emit("getGeneralMessage"),this.props.socket.on("message",(function(t){var a=e.state;a.messages=[].concat(Object(D.a)(a.messages),[{message:t.messageInput,userId:t.userId}]),e._isMounted&&e.setState(Object(i.a)({},a))})),this.props.socket.on("getGeneralMessage",(function(t){var a=e.state;a.messages=[].concat(Object(D.a)(a.messages),[{message:t.generalMessage,userId:t.userId,firstName:t.firstName,lastName:t.lastName}]),e._isMounted&&e.setState(Object(i.a)({},a))}))}},{key:"componentWillUnmount",value:function(e){this._isMounted=!1}},{key:"sendMessage",value:function(){this.props.socket.emit("message",{messageInput:this.state.messageInput,userId:this.props.auth.userId})}},{key:"render",value:function(){var e=this,t=this.state.messages.map((function(t,a){var s=!1;return s=t.userId===e.props.auth.userId,n.a.createElement("div",{key:a,className:"massages__item"},n.a.createElement("div",{className:"messages__author"},s?"I:":t.firstName+" "+t.lastName+":"),n.a.createElement("div",{className:s?"massages__text--right":"massages__text"},t.message))}));return n.a.createElement("div",{className:"ChatWrapper"},n.a.createElement("div",{className:"massages"},t),n.a.createElement("textarea",{className:"message",onChange:this.handleChange,value:this.state.messageInput}),n.a.createElement("button",{className:"sendMessage",onClick:function(){e.sendMessage()}},"sss"))}}]),t}(s.Component)),A=_(function(e){function t(e){var a;return Object(P.a)(this,t),(a=Object(q.a)(this,Object(B.a)(t).call(this,e)))._isMounted=!1,a.handleChange=function(e){var t=a.state;t.messageInput=e.target.value,a.setState(Object(i.a)({},t))},a.state={users:[]},a}return Object(J.a)(t,e),Object(R.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.auth.logged&&this.props.socket.emit("getUsers"),this.props.socket.on("getUsers",(function(t){var a=e.state;a.users=t,e._isMounted&&e.setState(Object(i.a)({},a))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"sendMessage",value:function(){this.props.socket.emit("message",{messageInput:this.state.messageInput,userId:this.props.auth.userId})}},{key:"render",value:function(){var e=this.state.users.map((function(e,t){return n.a.createElement("div",{key:t,className:""},e.firstName," ",e.lastName)}));return n.a.createElement("div",{className:"GeneralChat"},e)}}]),t}(s.Component)),H=a(72),K=a.n(H)()(v);var T=_((function(e){var t=Object(M.f)();return Object(s.useEffect)((function(){e.auth.logged||t.push("/")}),[e.auth.logged]),n.a.createElement("div",{className:"ChatWrapper"},n.a.createElement("div",{className:"container-fluid"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-3"},n.a.createElement(A,{socket:K})),n.a.createElement("div",{className:"col-md-6"},n.a.createElement(z,{socket:K})))))}));var Q=_((function(e){return Object(s.useEffect)((function(){e.checkLogged()}),[]),n.a.createElement(S.a,null,n.a.createElement(L,null),n.a.createElement(M.c,null,n.a.createElement(M.a,{path:"/chatWrapper",component:T}),n.a.createElement(M.a,{path:"/registration",component:U}),n.a.createElement(M.a,{path:"/",component:G})))})),V=(a(129),a(130),Object(l.d)(w,Object(l.a)(m.a)));o.a.render(n.a.createElement(c.a,{store:V},n.a.createElement(Q,null)),document.getElementById("app"))},73:function(e,t,a){e.exports=a(131)}},[[73,1,2]]]);
//# sourceMappingURL=main.7ff8625d.chunk.js.map