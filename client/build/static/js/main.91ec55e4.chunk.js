(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{127:function(e,a){},131:function(e,a,t){},132:function(e,a,t){},133:function(e,a,t){"use strict";t.r(a);var s=t(0),n=t.n(s),r=t(27),c=t.n(r),l=t(32),o=t(16),m=t(70),i=t(3),u="LOGIN",d="CHECK_LOGGED",p="LOGOUT",h=t(17),g=t.n(h),f="".concat(window.location.protocol,"/api/v1/"),v="".concat(window.location.host),E=function(e,a){g.a.post(f+"register-user",e).then((function(e){a(e)}))},N=function(e,a){g.a.post(f+"login",e).then((function(e){a(e)}))},_=t(43),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.localStorage.getItem("token"),a={};if(e){var t=e;a.token=t;(t=(t=t.replace("Bearer ","")).split("."))[0];var s=t[1];t[2];s=JSON.parse(_.Base64.decode(s)),a.userId=s.userId,a.firstName=s.firstName,a.lastName=s.lastName,a.email=s.email,g.a.defaults.headers.common.Authorization=e,a.logged=!0,localStorage.setItem("token",e)}return a},k={login:function(e,a){var t=this;return function(s){N({email:e,password:a},(function(e){var a=b(e.data);s(t.loginRequest(Object(i.a)({type:u},a)))}))}},loginRequest:function(e){return e},checkLogged:function(){var e=b();return Object(i.a)({type:d},e)},logout:function(){return{type:p}}},y={logged:!1,token:void 0,userId:"",firstName:"",lastName:"",email:""};var O=Object(o.c)({auth:function(e,a){if("undefined"===typeof e)return y;switch(a.type){case u:e=Object(i.a)({},a);break;case d:a.token?e=Object(i.a)({},a):(e.token=void 0,e.logged=!1);break;case p:window.localStorage.removeItem("token"),g.a.defaults.headers.common.Authorization="",e.token=void 0,e.logged=!1}return e}}),j=Object(i.a)({},k),w=function(e){return Object(i.a)({},e)},I=Object(i.a)({},j),S=function(e){return Object(l.b)(w,I)(e)},C=t(14),M=t(15);var x=S((function(e){var a=Object(C.f)(),t=e.auth.logged;return n.a.createElement("div",{className:"header"},n.a.createElement("div",{className:"logo"},"Chatick"),t?n.a.createElement("div",{className:"actions"},n.a.createElement("a",{href:"#",onClick:function(t){t.preventDefault(),e.logout(),a.push("/")}},"Logout")):n.a.createElement("div",{className:"actions"},n.a.createElement(M.b,{to:"/registration"},"Sign Up")))})),P=t(4),L=t(11);var q=S((function(e){var a=Object(C.f)();Object(s.useEffect)((function(){e.auth.logged&&a.push("/chatWrapper")}),[e.auth.logged]);var t=Object(s.useState)({email:"",password:""}),r=Object(L.a)(t,2),c=r[0],l=r[1],o=function(e){l(Object(i.a)({},c,Object(P.a)({},e.target.name,e.target.value)))};return n.a.createElement("div",{className:"page-wrapper sign-in form"},n.a.createElement("div",{className:"form"},n.a.createElement("div",{className:"form__title"},"LOGIN"),n.a.createElement("form",{onSubmit:function(a){a.preventDefault(),e.login(c.email,c.password)}},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"email"},"Email address"),n.a.createElement("input",{type:"email",className:"form-control",name:"email",id:"email",autoComplete:"username",placeholder:"Enter email",value:c.email,onChange:o}),n.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"},"We'll never share your email with anyone else.")),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",name:"password",id:"password",autoComplete:"current-password",placeholder:"Password",value:c.password,onChange:o})),n.a.createElement("div",{className:"form__buttons"},n.a.createElement("button",{type:"submit",className:"btn btn-primary w-100"},"Login")))))})),F=t(72);var G=S((function(e){var a=Object(C.f)(),t=Object(F.a)(),r=t.register,c=t.handleSubmit,l=(t.watch,t.errors,Object(s.useState)({firstName:"",lastName:"",email:"",password:""})),o=Object(L.a)(l,2),m=o[0],u=o[1],d=function(e){u(Object(i.a)({},m,Object(P.a)({},e.target.name,e.target.value)))};return n.a.createElement("div",{className:"page-wrapper sign-up"},n.a.createElement("div",{className:"form"},n.a.createElement("div",{className:"form__title"},"Registration"),n.a.createElement("form",{onSubmit:c((function(){E(m,(function(e){console.log(e)}))}))},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"firstName"},"First Name"),n.a.createElement("input",{type:"text",className:"form-control",id:"firstName",name:"firstName",placeholder:"First Name",ref:r({required:!0}),onChange:d,value:m.firstName})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"lastName"},"Last Name"),n.a.createElement("input",{type:"text",className:"form-control",id:"lastName",name:"lastName",placeholder:"Last Name",onChange:d,value:m.lastName})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"email"},"Email address"),n.a.createElement("input",{type:"email",className:"form-control",id:"email",name:"email",autoComplete:"username",placeholder:"Enter email",onChange:d,value:m.email})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",id:"password",name:"password",placeholder:"Password",autoComplete:"current-password",onChange:d,value:m.password})),n.a.createElement("div",{className:"form__buttons"},n.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Registration"),n.a.createElement("button",{onClick:function(){a.push("/")},className:"btn btn-dark"},"Cancel")))))})),H=t(5),U=t(29),z=t(30),D=t(33),W=t(31),R=t(34);var B={addSize:function(){document.querySelector("#app");var e=document.querySelector(".header"),a=document.querySelector(".chat__send-area"),t=document.querySelector(".page-wrapper"),s=document.querySelector(".chat .messages"),n=document.querySelector(".chat .chat__header");function r(){if(e&&a&&t&&s&&n){var r=e.clientHeight,c=a.clientHeight,l=n.clientHeight;t.style.paddingTop="".concat(r,"px"),s.style.height="calc(100% - ".concat(c+l,"px)")}}r(),window.addEventListener("resize",(function(){r()}))},scrollMessage:function(){var e=document.querySelector(".chat .messages");e&&(e.scrollTop=e.scrollHeight)}},J=t(21),T=t.n(J),A=S(function(e){function a(e){var t;return Object(U.a)(this,a),(t=Object(D.a)(this,Object(W.a)(a).call(this,e)))._isMounted=!1,t.keyPressed=function(e){"Enter"===e.key&&t.sendMessage()},t.handleChange=function(e){var a=t.state;a.messageInput=e.target.value.replace(/\n/g,""),t.setState(Object(i.a)({},a))},t.state={socketIdPrev:"",messageInput:"",messages:[]},t.props.socket.on("connect",(function(){})),t}return Object(R.a)(a,e),Object(z.a)(a,[{key:"componentDidMount",value:function(){var e=this;B.addSize(),this.props.auth.logged&&(this._isMounted=!0,this.props.socket.on("message",(function(a){var t=e.state;t.messages=[].concat(Object(H.a)(t.messages),[{message:a.messageInput,userId:a.userId,firstName:a.firstName,lastName:a.lastName}]),e._isMounted&&e.setState(Object(i.a)({},t)),B.scrollMessage()})),this.props.socket.id!==this.state.socketIdPrev&&this.props.socket.emit("getGeneralMessage"),this.props.socket.on("getGeneralMessage",(function(a){if(e.props.socket.id!==e.state.socketIdPrev){var t=e.state;t.socketIdPrev=e.props.socket.id,t.messages=a,e._isMounted&&e.setState(Object(i.a)({},t)),B.scrollMessage()}})))}},{key:"componentWillUnmount",value:function(e){this._isMounted=!1}},{key:"sendMessage",value:function(){if(""!==this.state.messageInput){this.props.socket.emit("message",{messageInput:this.state.messageInput,userId:this.props.auth.userId,firstName:this.props.auth.firstName,lastName:this.props.auth.lastName});var e=this.state;e.messageInput="",this.setState(Object(i.a)({},e))}}},{key:"render",value:function(){var e=this,a=this.state.messages.map((function(a,t){var s=!1;return s=a.userId===e.props.auth.userId,n.a.createElement("div",{key:t,className:s?"messages__item messages__item--my-message":"messages__item"},n.a.createElement("div",{className:"messages__photo"},n.a.createElement("img",{src:T.a,alt:""}),n.a.createElement("div",{className:"user-status user-status--online"})),n.a.createElement("div",{className:"messages__block"},n.a.createElement("div",{className:"messages__author"},a.firstName+" "+a.lastName,n.a.createElement("span",{className:"messages__time"},"8min")),n.a.createElement("div",{className:"messages__text"},a.message,n.a.createElement("div",{className:"messages__read-message"},n.a.createElement("i",{className:"icofont-check-alt"})))))}));return n.a.createElement("div",{className:"chat"},n.a.createElement("div",{className:"chat__header"},n.a.createElement("div",{className:"chat__head-text"},"@General chat"),n.a.createElement("div",{className:"chat__close"},n.a.createElement("i",{className:"icofont-close-line"}))),n.a.createElement("div",{className:"messages"},a),n.a.createElement("div",{className:"chat__send-area"},n.a.createElement("div",{className:"chat__typing"},n.a.createElement("span",null,"Petya and Valera are typing")),n.a.createElement("div",{className:"chat__textarea-wrap"},n.a.createElement("div",{className:"chat__expressionless"},n.a.createElement("i",{className:"icofont-expressionless"})),n.a.createElement("input",{type:"text",className:"chat__input-message",placeholder:"Enter your message",onChange:this.handleChange,value:this.state.messageInput,onKeyPress:this.keyPressed})),n.a.createElement("div",{className:"chat__send-message",onClick:function(){e.sendMessage()}},n.a.createElement("i",{className:"icofont-paper-plane"}))))}}]),a}(s.Component)),K=S(function(e){function a(e){var t;return Object(U.a)(this,a),(t=Object(D.a)(this,Object(W.a)(a).call(this,e)))._isMounted=!1,t.handleChange=function(e){var a=t.state;a.messageInput=e.target.value,t.setState(Object(i.a)({},a))},t.state={users:[]},t}return Object(R.a)(a,e),Object(z.a)(a,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.auth.logged&&this.props.socket.emit("getUsers"),this.props.socket.on("getUsers",(function(a){var t=e.state;t.users=a,e._isMounted&&e.setState(Object(i.a)({},t))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"sendMessage",value:function(){this.props.socket.emit("message",{messageInput:this.state.messageInput,userId:this.props.auth.userId})}},{key:"render",value:function(){var e=this.state.users.map((function(e,a){return n.a.createElement("div",{key:a,className:"users__item"},n.a.createElement("div",{className:"users__photo"},n.a.createElement("img",{src:T.a,alt:""}),n.a.createElement("div",{className:"user-status user-status--online"})),n.a.createElement("div",{className:"users__info"},n.a.createElement("div",{className:"users__name"},e.firstName," ",e.lastName,n.a.createElement("span",{className:"users__time"},"8min")),n.a.createElement("div",{className:"users__last-message"},"Hey last, can")))}));return n.a.createElement("div",{className:"users"},n.a.createElement("div",{className:"users__profile"},n.a.createElement("div",{className:"users__item"},n.a.createElement("div",{className:"users__photo"},n.a.createElement("img",{src:T.a,alt:""}),n.a.createElement("div",{className:"user-status user-status--online"})),n.a.createElement("div",{className:"users__info"},n.a.createElement("div",{className:"users__name"},"Petya Maiko"),n.a.createElement("div",{className:"users__status-text"},"Status")),n.a.createElement("div",{className:"users__notification"},n.a.createElement("i",{className:"icofont-notification"})))),n.a.createElement("div",{className:"users__search"},n.a.createElement("input",{type:"text",className:"users__search-input",placeholder:"Search"})),e)}}]),a}(s.Component)),V=t(73),Q=t.n(V)()(v);var X=S((function(e){var a=Object(C.f)();return Object(s.useEffect)((function(){e.auth.logged||a.push("/")}),[e.auth.logged]),n.a.createElement("div",{className:"page-wrapper chat-wrapper"},n.a.createElement("div",{className:"container-fluid h-100"},n.a.createElement("div",{className:"row h-100"},n.a.createElement("div",{className:"col-md-3 h-100 px-0"},n.a.createElement(K,{socket:Q})),n.a.createElement("div",{className:"col-md-6 h-100 px-0"},n.a.createElement(A,{socket:Q})),n.a.createElement("div",{className:"col-md-3 h-100 px-0"},n.a.createElement("div",{className:"details"})))))}));var Y=S((function(e){return Object(s.useEffect)((function(){e.checkLogged()}),[]),n.a.createElement(M.a,null,n.a.createElement(x,null),n.a.createElement(C.c,null,n.a.createElement(C.a,{path:"/chatWrapper",component:X}),n.a.createElement(C.a,{path:"/registration",component:G}),n.a.createElement(C.a,{path:"/",component:q})))})),Z=(t(130),t(131),t(132),Object(o.d)(O,Object(o.a)(m.a)));c.a.render(n.a.createElement(l.a,{store:Z},n.a.createElement(Y,null)),document.getElementById("app"))},21:function(e,a,t){e.exports=t.p+"static/media/ava.e4c49134.png"},74:function(e,a,t){e.exports=t(133)}},[[74,1,2]]]);
//# sourceMappingURL=main.91ec55e4.chunk.js.map