(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{125:function(e,t){},129:function(e,t,a){},130:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(31),o=a.n(r),c=a(33),l=a(15),m=a(68),i=a(5),u="LOGIN",d="CHECK_LOGGED",p="LOGOUT",h=a(16),g=a.n(h),f="".concat(window.location.protocol,"/api/v1/.").concat(window.location.hostname),v=function(e,t){g.a.post(f+"register-user",e).then((function(e){t(e)}))},b=function(e,t){g.a.post(f+"login",e).then((function(e){t(e)}))},E=a(40),N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.localStorage.getItem("token"),t={};if(e){var a=e;t.token=a;(a=(a=a.replace("Bearer ","")).split("."))[0];var n=a[1];a[2];n=JSON.parse(E.Base64.decode(n)),t.userId=n.userId,t.firstName=n.firstName,t.lastName=n.lastName,t.email=n.email,g.a.defaults.headers.common.Authorization=e,t.logged=!0,localStorage.setItem("token",e)}return t},O={login:function(e,t){var a=this;return function(n){b({email:e,password:t},(function(e){var t=N(e.data);n(a.loginRequest(Object(i.a)({type:u},t)))}))}},loginRequest:function(e){return e},checkLogged:function(){var e=N();return Object(i.a)({type:d},e)},logout:function(){return{type:p}}},j={logged:!1,token:void 0,userId:"",firstName:"",lastName:"",email:""};var k=Object(l.c)({auth:function(e,t){if("undefined"===typeof e)return j;switch(t.type){case u:e=Object(i.a)({},t);break;case d:t.token?e=Object(i.a)({},t):(e.token=void 0,e.logged=!1);break;case p:window.localStorage.removeItem("token"),g.a.defaults.headers.common.Authorization="",e.token=void 0,e.logged=!1}return e}}),w=Object(i.a)({},O),y=function(e){return Object(i.a)({},e)},C=Object(i.a)({},w),I=function(e){return Object(c.b)(y,C)(e)},_=a(41),M=a(3);var S=I((function(e){var t=Object(M.g)(),a=e.auth.logged;return s.a.createElement("div",{className:"header"},s.a.createElement("div",{className:"logo"},"Chatick"),a?s.a.createElement("div",{className:"actions"},s.a.createElement("a",{href:"#",onClick:function(a){a.preventDefault(),e.logout(),t.push("/")}},"Logout")):s.a.createElement("div",{className:"actions"},s.a.createElement(_.a,{to:"/registration"},"Sign Up")))})),L=a(8),x=a(4),F=a(12);var W=I((function(e){var t=Object(M.g)(),a=Object(n.useState)({email:"",password:""}),r=Object(F.a)(a,2),o=r[0],c=r[1],l=function(e){c(Object(i.a)({},o,Object(x.a)({},e.target.name,e.target.value)))};return s.a.createElement("div",{className:"sign-in form"},s.a.createElement("div",{className:"form"},s.a.createElement("div",{className:"form__title"},"LOGIN"),s.a.createElement("form",{onSubmit:function(a){a.preventDefault(),e.login(o.email,o.password),e.auth.logged&&t.push("/chatWrapper")}},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"email"},"Email address"),s.a.createElement("input",{type:"email",className:"form-control",name:"email",id:"email",autoComplete:"username",placeholder:"Enter email",value:o.email,onChange:l}),s.a.createElement("small",{id:"emailHelp",className:"form-text text-muted"},"We'll never share your email with anyone else.")),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"password"},"Password"),s.a.createElement("input",{type:"password",className:"form-control",name:"password",id:"password",autoComplete:"current-password",placeholder:"Password",value:o.password,onChange:l})),s.a.createElement("div",{className:"form__buttons"},s.a.createElement("button",{type:"submit",className:"btn btn-primary w-100"},"Login")))))})),D=a(70);var G=I((function(e){var t=Object(M.g)(),a=Object(D.a)(),r=a.register,o=a.handleSubmit,c=(a.watch,a.errors,Object(n.useState)({firstName:"",lastName:"",email:"",password:""})),l=Object(F.a)(c,2),m=l[0],u=l[1],d=function(e){u(Object(i.a)({},m,Object(x.a)({},e.target.name,e.target.value)))};return s.a.createElement("div",{className:"sign-up"},s.a.createElement("div",{className:"form"},s.a.createElement("div",{className:"form__title"},"Registration"),s.a.createElement("form",{onSubmit:o((function(){v(m,(function(e){console.log(e)}))}))},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"firstName"},"First Name"),s.a.createElement("input",{type:"text",className:"form-control",id:"firstName",name:"firstName",placeholder:"First Name",ref:r({required:!0}),onChange:d,value:m.firstName})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"lastName"},"Last Name"),s.a.createElement("input",{type:"text",className:"form-control",id:"lastName",name:"lastName",placeholder:"Last Name",onChange:d,value:m.lastName})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"email"},"Email address"),s.a.createElement("input",{type:"email",className:"form-control",id:"email",name:"email",autoComplete:"username",placeholder:"Enter email",onChange:d,value:m.email})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"password"},"Password"),s.a.createElement("input",{type:"password",className:"form-control",id:"password",name:"password",placeholder:"Password",autoComplete:"current-password",onChange:d,value:m.password})),s.a.createElement("div",{className:"form__buttons"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Registration"),s.a.createElement("button",{onClick:function(){t.push("/")},className:"btn btn-dark"},"Cancel")))))})),U=a(19),P=a(20),R=a(22),q=a(21),A=a(23),B=a(6),J=I(function(e){function t(e){var a;return Object(U.a)(this,t),(a=Object(R.a)(this,Object(q.a)(t).call(this,e)))._isMounted=!1,a.handleChange=function(e){var t=a.state;t.messageInput=e.target.value,a.setState(Object(i.a)({},t))},a.state={messageInput:"",messages:[]},a}return Object(A.a)(t,e),Object(P.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.socket.on("message",(function(t){var a=e.state;a.messages=[].concat(Object(B.a)(a.messages),[{message:t.messageInput,userId:t.userId}]),e._isMounted&&e.setState(Object(i.a)({},a))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"sendMessage",value:function(){this.props.socket.emit("message",{messageInput:this.state.messageInput,userId:this.props.auth.userId})}},{key:"render",value:function(){var e=this,t=this.state.messages.map((function(t,a){var n=!1;return n=t.userId===e.props.auth.userId,s.a.createElement("div",{key:a,className:"massages__item"},s.a.createElement("div",{className:"messages__author"},n?"I:":e.props.auth.firstName+" "+e.props.auth.lastName+":"),s.a.createElement("div",{className:n?"massages__text--right":"massages__text"},t.message))}));return s.a.createElement("div",{className:"ChatWrapper"},s.a.createElement("div",{className:"massages"},t),s.a.createElement("textarea",{className:"message",onChange:this.handleChange,value:this.state.messageInput}),s.a.createElement("button",{className:"sendMessage",onClick:function(){e.sendMessage()}},"sss"))}}]),t}(n.Component)),z=I(function(e){function t(e){var a;return Object(U.a)(this,t),(a=Object(R.a)(this,Object(q.a)(t).call(this,e)))._isMounted=!1,a.handleChange=function(e){var t=a.state;t.messageInput=e.target.value,a.setState(Object(i.a)({},t))},a.state={users:[]},a}return Object(A.a)(t,e),Object(P.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.socket.emit("getUsers"),this.props.socket.on("getUsers",(function(t){var a=e.state;a.users=t,e._isMounted&&e.setState(Object(i.a)({},a))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"sendMessage",value:function(){this.props.socket.emit("message",{messageInput:this.state.messageInput,userId:this.props.auth.userId})}},{key:"render",value:function(){var e=this.state.users.map((function(e,t){return console.log(e),s.a.createElement("div",{key:t,className:""},e.firstName," ",e.lastName)}));return s.a.createElement("div",{className:"GeneralChat"},e)}}]),t}(n.Component)),H=a(71),K=a.n(H),T=I(function(e){function t(){var e,a;Object(U.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(R.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(s)))).socket=K()("http://localhost:5000"),a}return Object(A.a)(t,e),Object(P.a)(t,[{key:"componentDidMount",value:function(){this.socket.on("connect",(function(){console.log("client connect")}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"ChatWrapper"},s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-3"},s.a.createElement(z,{socket:this.socket})),s.a.createElement("div",{className:"col-md-6"},s.a.createElement(J,{socket:this.socket})))))}}]),t}(n.Component)),Q=Object(L.a)(),V=Q.location.pathname;var X=I((function(e){return Object(n.useEffect)((function(){e.checkLogged()}),[]),s.a.createElement(M.c,{history:Q},s.a.createElement(S,null),s.a.createElement(M.d,null,s.a.createElement(M.b,{path:"/chatWrapper",component:T}),s.a.createElement(M.b,{path:"/registration",component:G}),s.a.createElement(M.b,{path:"/",component:W})),e.auth.logged?s.a.createElement(M.a,{to:"/chatWrapper"}):"/registration"!==V?s.a.createElement(M.a,{to:"/"}):"")})),Y=(a(128),a(129),Object(l.d)(k,Object(l.a)(m.a)));o.a.render(s.a.createElement(c.a,{store:Y},s.a.createElement(X,null)),document.getElementById("app"))},72:function(e,t,a){e.exports=a(130)}},[[72,1,2]]]);
//# sourceMappingURL=main.242107b6.chunk.js.map